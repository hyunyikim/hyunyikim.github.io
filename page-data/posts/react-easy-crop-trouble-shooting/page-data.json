{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/react-easy-crop-trouble-shooting","result":{"data":{"markdownRemark":{"id":"effa708f-5e5d-5605-b6f6-86a0b5d215e8","html":"<p>이미지를 크롭해 파일로 만드는 기능을 구현하던 중 파일의 사이즈가 원본 이미지 파일보다 더 커지는 현상이 발생했다. 원인을 찾아보니 파일의 사이즈는 작은데 이미지의 너비와 높이가 3000픽셀이 넘어가는 파일들이 존재했고 그런 파일들을 크롭한 후 파일로 만들 때 원본 이미지의 너비, 높이가 크다보니 canvas로 이미지를 그려 크롭을 하고 난 후에도 이미지의 너비, 높이가 크고 거기서 만들어진 파일의 크기도 커지는 문제였다.</p>\n<p>첫 번째로, 크롭 라이브러리로 react-easy-crop을 사용했는데 크롭하고자 하는 크기의 비율만큼 크롭된 결과물의 크기를 줄였다.</p>\n<p>두 번째로, canvas에 이미지를 그릴 때 좌표와 함께 조정된 사이즈의 이미지 너비, 높이를 함께 전달해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Image</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 1)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 2)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> image width<span class=\"token punctuation\">,</span> image height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>처음에는 이미지 엘리먼트를 생성할 때 크기를 지정해주었기 때문에 캔버스에 이미지를 그릴 때 따로 이미지의 크기를 지정해주지 않아도 이미지가 모두 캔버스 안에 그려질 것이라고 생각했다. 하지만 이때 그려지는 이미지는 이미지의 원본 사이즈(intrinsic size)를 기준으로 그려졌고 2번과 같이 캔버스에 그려질 이미지 사이즈를 직접 정의해줘야 이미지가 잘리지 않고 캔버스에 그려진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 776px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ce4ebb3617268ed77757c4e6acd02dd9/167b5/change-image-size-example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACEklEQVQ4y6WTz0/TYByH918Q2Nq1W0fHuu5H263tum52DjY2yAIJYAyo8QAHg4FIggQvXIhRY+LBxANejHgxHvBk/Oce89Zs/ogjRg9P3/fbvvn06fd9m1BUjWnI6Qy9wZDR2jrLow06SwMkSfnj2rSSjcfE9MAcc0mZdx8/c/XlK5efrjg9O2dmZg41k/uXQI1kKs3rt5dcXLzh/YdLjk6e/F3guPgdKZ3h7OkLDvbvc3h8woOj0/8zTMkZzp8/49XLM3Z297iz95DZ2dT1gWIyRmzCmHF98OiQx8f7bG6t0Y4iUpJ6/aZkND1+Y6li49R97JqP5biYJQvPb2LZdVrtDpWqgySrTGvRJLBcdajadSzHIwgj/GYbrxFi1zxsx8UwKxSMEmapSlbTp/Zb3BdiCXHR80XyCyauH1Jzg9i0YtXoD1YJWxHDlRGdbo+CUUYWgZMe5n5CQ83Ok8hqeWzHiw0Eda9JzW0gzBeX+jF110NRMiSTErKs/IIkpSdjbChUU5ISW5plKw73Gy2qtosb9gg7Q4xqQKHSwKj4mHaLoqjLXjwvOTcoWiGm3UbLLfw4NvN5gwWjxLxeiNELZYLeDn73FtFol2i0R9C7jd/dpNnfpjW8Rzi4i9/dorG4hXdzg5xe/G44/m8nx0VWUbM6TriCG61jBcvYzSFWo48dDLCDZWqt1fi5MBRrRf/EJ38D8UmX2iLJzNcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ce4ebb3617268ed77757c4e6acd02dd9/8ac56/change-image-size-example.webp 240w,\n/static/ce4ebb3617268ed77757c4e6acd02dd9/d3be9/change-image-size-example.webp 480w,\n/static/ce4ebb3617268ed77757c4e6acd02dd9/bac22/change-image-size-example.webp 776w\"\n              sizes=\"(max-width: 776px) 100vw, 776px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ce4ebb3617268ed77757c4e6acd02dd9/8ff5a/change-image-size-example.png 240w,\n/static/ce4ebb3617268ed77757c4e6acd02dd9/e85cb/change-image-size-example.png 480w,\n/static/ce4ebb3617268ed77757c4e6acd02dd9/167b5/change-image-size-example.png 776w\"\n            sizes=\"(max-width: 776px) 100vw, 776px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ce4ebb3617268ed77757c4e6acd02dd9/167b5/change-image-size-example.png\"\n            alt=\"이미지 개발자 도구\"\n            title=\"이미지 개발자 도구\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>이미지 엘리먼트를 생성할 때 설정하는 width, height는 <code class=\"language-text\">rendered size</code>이고 <code class=\"language-text\">intrinsic size</code>는 이미지의 원본 사이즈이다. 이 <code class=\"language-text\">intrinsic size</code>는 <code class=\"language-text\">HTMLImageElement.naturalWidth,</code> <code class=\"language-text\">HTMLImageElement.naturalHeight</code>로 접근이 가능하다.</p>\n<hr>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/Image\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/Image</a></p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/naturalWidth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/naturalWidth</a></p>\n<hr>","fields":{"slug":"/posts/react-easy-crop-trouble-shooting","tagSlugs":["/tag/reacteasycrop/"]},"frontmatter":{"date":"2022-12-18T00:00:00.000Z","description":"이미지의 사이즈 찾기","tags":["react-easy-crop"],"title":"react-easy-crop 트러블 슈팅","socialImage":""}}},"pageContext":{"slug":"/posts/react-easy-crop-trouble-shooting"}},"staticQueryHashes":["251939775","357378587","401334301"]}